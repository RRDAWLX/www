<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"/>
<title>Zepto Test</title>

<style>
* {margin:0; border:0; padding:0;}
div {height:300px; background-color:#333; color:white;}
</style>

<script src="zepto.js"></script>
</head>

<body>
<div id="touch"></div>

<script>


var O = {
	flag: false,

	a: function () {
		var that = this;

		return $.ajax({
			url: 'ajax.php',
			type: 'get',
			dataType: 'json',
			success: function (res) {
				that.flag = true;
				console.log('success', that.flag);
			},
			error: function (x,s,e){
				console.log('error', that.flag);
			},
			complete: function () {
				console.log('a complete', that.flag);
			}
		});
	},

	b: function () {
		var that = this;

		return $.ajax({
			url: 'ajax.php',
			type: 'get',
			dataType: 'json'
		}).always(function(){
			console.log('b', that.flag);
		});
	},

	c: function () {
		console.log('c', this.flag);
	}
}

O.a()
.then($.proxy(O.b, O), $.proxy(O.b, O))
.always($.proxy(O.c, O));
</script>
</body>
</html>
