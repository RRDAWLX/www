<!Doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Test</title>
<style>
* {margin: 0; padding: 0; border: 0;}
html, body {width: 100%; height: 100%;}
#position {position: relative; padding:5px 0; background-color:#00F;}
#position:after {position:absolute; width:100%; padding-top:30%; content:''; background-color:#FF0;}
</style>

<script src="jquery.min.js"></script>
</head>

<body>
<div id="position"></div>


<script>
var p;
p = $.Deferred(function(d){
	console.log(p);
	d.resolve();
	console.log(p);
}).then(function(){
	console.log(p);
	
	var p1 = $.Deferred().promise();
	
	console.log(p);
	
	return $.extend({a:1}, p1);
});

console.log(p);

</script>
</body>
</html>
